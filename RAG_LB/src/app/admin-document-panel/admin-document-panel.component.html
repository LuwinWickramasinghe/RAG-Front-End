<div class="w-full bg-white shadow-lg rounded-xl border border-gray-200">
  <!-- Header -->
  <div class="bg-gray-100 p-4 rounded-t-xl flex justify-between items-center">
    <div class="flex items-center">
      <span class="text-red-600 mr-2">
        <span-lucide [img]="FileText" class="my-icon"></span-lucide>
      </span>
      <h2 class="text-lg font-semibold text-gray-800">Document Management</h2>
    </div>
    <div class="flex space-x-3">
      <input type="file" id="fileInput" class="hidden" (change)="onFileSelected($event)" />
      <button
        class="bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600"
        (click)="triggerFileInput()"
      >
        <span class="mr-2">&#8682;</span>
        Upload New Document
      </button>

      <!-- Process Files Button -->
      <button
        class="bg-blue-500 text-white px-4 py-2 rounded-md flex items-center"
        (click)="processFiles()"
      >
        <span-lucide [img]="Settings" class="my-icon"></span-lucide>
        <span class="ml-2">Process Files</span>
      </button>
    </div>
  </div>

  <!-- Loading Indicator -->
  <div *ngIf="isLoading" class="p-6 flex justify-center items-center">
    <span-lucide [img]="Loader2" class="animate-spin text-gray-600 w-6 h-6"></span-lucide>
    <span class="ml-2 text-gray-600">Loading documents...</span>
  </div>

  <!-- Document Table -->
  <div *ngIf="!isLoading" class="overflow-x-auto p-4">
    <p-table #dt [value]="documents" [(selection)]="selectedDocumentObjects" dataKey="name" [paginator]="true" [rows]="10" [rowsPerPageOptions]="[10, 25, 50]" [loading]="isLoading" [rowHover]="true" [lazy]="false" [globalFilterFields]="['name']">
      <!-- Table Caption -->
      <ng-template #caption>
        <div class="flex justify-between">
          <p-button [outlined]="true" icon="pi pi-filter-slash" label="Clear" (click)="dt.clear()" />
          <p-iconField iconPosition="left">
            <p-inputIcon>
              <i class="pi pi-search"></i>
            </p-inputIcon>     
            <input pInputText type="text" [(ngModel)]="searchValue" (input)="filterGlobal($event)" placeholder="Keyboard Search" />
          </p-iconField>
        </div>
      </ng-template>
    
      <!-- Table Header -->
      <ng-template pTemplate="header">
        <tr>
          <th pSelectableColumn>
            <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
          </th>
          <th pSortableColumn="name">File Name <p-sortIcon field="name"></p-sortIcon></th>
          <th pSortableColumn="uploader">Uploaded By <p-sortIcon field="uploader"></p-sortIcon></th>
          <th pSortableColumn="uploadDate">Upload Date <p-sortIcon field="uploadDate"></p-sortIcon></th>
          <th pSortableColumn="status">Status <p-sortIcon field="status"></p-sortIcon></th>
          <th>Actions</th>
        </tr>
      </ng-template>
    
      <!-- Table Body -->
      <ng-template pTemplate="body" let-doc>
        <tr [pSelectableRow]="doc">
          <td>
            <p-tableCheckbox [value]="doc" [disabled]="selectedDocuments.length >= 5 && !selectedDocuments.includes(doc.name) || doc.status === 'Processed'"></p-tableCheckbox>
          </td>
          <td>{{ doc.name }}</td>
          <td>{{ doc.uploader }}</td>
          <td>{{ doc.uploadDate }}</td>
          <td>
            <p-tag [value]="doc.status" [severity]="doc.status === 'Processed' ? 'success' : 'danger'"></p-tag>
          </td>
          <td>
            <p-button icon="pi pi-check" class="p-button-rounded p-button-text p-button-success"></p-button>
            <p-button icon="pi pi-times" class="p-button-rounded p-button-text p-button-danger"></p-button>
          </td>
        </tr>
      </ng-template>
    
      <!-- Empty Message -->
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="6">No documents found.</td>
        </tr>
      </ng-template>
    </p-table>
    
  </div>
</div>
